<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Model Report</title>
    <style>
        body { font-family: Arial, sans-serif; }
        .container { width: 80%; margin: auto; }
        .section { margin: 20px 0; }
        .section-title { font-size: 24px; margin-bottom: 10px; }
        .metrics-table { width: 100%; border-collapse: collapse; }
        .metrics-table th, .metrics-table td { border: 1px solid #ddd; padding: 8px; text-align: center; }
        .metrics-table th { background-color: #f2f2f2; }
        .image { text-align: center; margin: 20px 0; }
        .image-container {display: flex; }
    </style>
</head>
<body>
    <div class="container">
        <div class="section">
            <div class="section-title">Model Metrics</div>
            <table class="metrics-table">
                <tr>
                    <th>Metric</th>
                    <th>Model</th>
                    <th>Random Prior Testing</th>
                    <th>Testing Everyone</th>
                </tr>
                <tr>
                    <td>Precision</td>
                    <td>{{ precision }}</td>
                    <td>{{ precision_random }}</td>
                    <td>{{ precision_const }}</td>
                </tr>
                <tr>
                    <td>Recall</td>
                    <td>{{ recall }}</td>
                    <td>{{ recall_random }}</td>
                    <td>{{ recall_const }}</td>

                </tr>
                <tr>
                    <td>F1-Score</td>
                    <td>{{ f_score }}</td>
                    <td>{{ f_score_random }}</td>
                    <td>{{ f_score_const }}</td>
                </tr>
                <tr>
                    <td>ROC AUC</td>
                    <td>{{ roc_auc }}</td>
                    <td>{{ roc_auc_random }}</td>
                    <td>{{ roc_auc_const }}</td>
                </tr>
                <tr>
                    <td>Precision-Recall AUC</td>
                    <td>{{ pr_auc }}</td>
                    <td>{{ pr_auc_random }}</td>
                    <td>{{ pr_auc_const }}</td>
                </tr>
                <tr>
                    <td>Balanced Accuracy</td>
                    <td>{{ balanced_accuracy }}</td>
                    <td>{{ balanced_accuracy_random }}</td>
                    <td>{{ balanced_accuracy_const }}</td>
                </tr>
                <tr>
                    <td>Sensitivity</td>
                    <td>{{ sensitivity }}</td>
                    <td>{{ sensitivity_random }}</td>
                    <td>{{ sensitivity_const }}</td>
                </tr>
                <tr>
                    <td>Specificity</td>
                    <td>{{ specificity }}</td>
                    <td>{{ specificity_random }}</td>
                    <td>{{ specificity_const }}</td>
                </tr>
                <tr>
                    <td>G-Mean</td>
                    <td>{{ gmean }}</td>
                    <td>{{ gmean_random }}</td>
                    <td>{{ gmean_const }}</td>
                </tr>
                <tr>
                    <td>True Positive Rate</td>
                    <td>{{ tpr }}</td>
                    <td>{{ tpr_random }}</td>
                    <td>{{ tpr_const }}</td>
                </tr>
                <tr>
                    <td>False Positive Rate</td>
                    <td>{{ fpr }}</td>
                    <td>{{ fpr_random }}</td>
                    <td>{{ fpr_const }}</td>
                </tr>
                <tr>
                    <td>P(T1D | +)</td>
                    <td>{{ p_t1d_given_positive }}</td>
                    <td>{{ p_t1d_given_positive_random }}</td>
                    <td>{{ p_t1d_given_positive_const }}</td>
                </tr>
                <tr>
                    <td>Bayes Factor</td>
                    <td>{{ bayes_factor }}</td>
                    <td>{{ bayes_factor_random }}</td>
                    <td>{{ bayes_factor_const }}</td>
                </tr>
                <tr>
                    <td>Log Loss</td>
                    <td>{{ log_loss }}</td>
                    <td>{{ log_loss_random }}</td>
                    <td>{{ log_loss_const }}</td>
                </tr>
                <tr>
                    <td>Brier Score Loss</td>
                    <td>{{ brier_score_loss }}</td>
                    <td>{{ brier_score_loss_random }}</td>
                    <td>{{ brier_score_loss_const }}</td>
                </tr>
                <tr>
                    <td>Brier Skill Score</td>
                    <td>{{ brier_skill_score }}</td>
                    <td>{{ brier_skill_score_random }}</td>
                    <td>{{ brier_skill_score_const }}</td>
                </tr>
            </table>
        </div>
        <div class="container">
            <div class="section">
                <div class="section-title">Confusion Matrix</div>
                <div class="image-container">
                    <div class="image-item">
                        <img src="{{ confusion_matrix_image }}" alt="Confusion Matrix">
                    </div>
                    <div class="image-item">
                        <img src="{{ confusion_matrix_image_ref }}" alt="Confusion Matrix Ref">
                    </div>
                    <div class="image-item">
                        <img src="{{ confusion_matrix_image_const }}" alt="Confusion Matrix Const">
                    </div>
                </div>
            </div>
        </div>
        <div class="container">
            <div class="section">
                <div class="section-title">Precision-Recall Curve</div>
                <div class="image-container">
                    <div class="image-item">
                        <img src="{{ pr_curve_image }}" alt="Precision-Recall Curve">
                    </div>
                    <div class="image-item">
                        <img src="{{ pr_curve_image_ref }}" alt="Precision-Recall Curve Ref">
                    </div>
                    <div class="image-item">
                        <img src="{{ pr_curve_image_const }}" alt="Precision-Recall Curve Const">
                    </div>
                </div>
            </div>
        </div>
        <div class="container">
            <div class="section">
                <div class="section-title">Metadata</div>
                 <table class="metrics-table">
                    <tr>
                        <th>Name</th>
                        <th>Value</th>
                    </tr>
                    <tr>
                        <td>Report Date</td>
                        <td>{{ report_datetime }}</td>
                    </tr>
                    <tr>
                        <td>Train size</td>
                        <td>{{ train_dataset_size }}</td>
                    </tr>
                    <tr>
                        <td>Test size</td>
                        <td>{{ test_dataset_size }}</td>
                    </tr>
                    <tr>
                        <td>Train T1D ratio</td>
                        <td>{{ train_t1d_ratio }}</td>
                    </tr>
                    <tr>
                        <td>Test T1D ratio</td>
                        <td>{{ test_t1d_ratio }}</td>
                    </tr>
                </table>
            </div>
        </div>
        <div class="container">
            <div class="section">
                <div class="section-title">Model Parameters</div>
                <pre>{{ model_params }}</pre>
            </div>
        </div>
        <div class="container">
            <div class="section">
                <div class="section-title">Additional Notes</div>
                <p>{{ notes }}</p>
            </div>
        </div>
    </div>
</body>
</html>
